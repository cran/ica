sdiag <- function(x){ if(length(x)<2L) matrix(x) else diag(x) }